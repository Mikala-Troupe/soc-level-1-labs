# Week 1 â€” Email Header and Sender Analysis ğŸ“¨

## Objective
This lab focused on analyzing the structure of raw email headers to trace message origin, verify sender authenticity, and identify potential signs of spoofing or compromise.

---

### ğŸ“¥ Inspecting the Raw Email
![Screenshot 1 â€“ Sample email headers](./screenshots/header-sample.png)  
Opened the sample email file to view its full headers and message body.

![Screenshot 2 â€“ View in terminal](./screenshots/email-terminal.png)  
Displayed the email in the terminal using the `cat` command to see the underlying HTML markup that composes the body.

![Screenshot 3 â€“ Locate specific header fields](./screenshots/grep-from.png)  
Used the `grep` command to extract the **From** header directly from the raw file.

![Screenshot 4 â€“ Open in Sublime Text](./screenshots/sublime-view.png)  
Opened the same file in Sublime Text (`subl` command) for easier reading and annotation.

---

### ğŸ§© Understanding Important Header Fields
![Screenshot 5 â€“ Annotated header fields](./screenshots/header-details.png)

| Header | Description / Use |
|--------|-------------------|
| **From** | Identifies the sender; document it for correlation or searches within the mail gateway. |
| **Date** | Timestamp when the message was created; helps trace the email timeline. |
| **Subject** | Acts as a fingerprint; recurring subjects can reveal campaign patterns. |
| **Message-ID** | Unique identifier generated by the first mail server. Duplicate IDs can indicate replay or malicious reuse. |
| **To** | Recipient information; useful for determining message scope and potential impact. |
| **Reply-To** | Address where replies are directed; mismatch with â€œFromâ€ can signal phishing or forwarding abuse. |
| **Return-Path** | The envelope sender/bounce address. Compare to â€œFromâ€ for inconsistencies. |
| **X-Type Headers** | Custom metadata added by providers or security filters (spam scores, auth results, etc.). |
| **X-Sender-IP / X-Originating-IP** | Often reveals the original sending IPâ€”useful for geolocation, IP reputation, or reverse DNS lookups. |
| **Received** | Logs each mail server hop. The chain is read **bottom â†’ top** to trace message flow; these are reliable because each hop is added by an MTA. Think of them as passport stamps for the emailâ€™s journey. |

---

### ğŸŒ Tracing Sender and Infrastructure
![Screenshot 6 â€“ WHOIS lookup on IP](./screenshots/whois-terminal.png)  
Ran the `whois` command on the IP address from the final **Received** header to identify the owning network.

![Screenshot 7 â€“ WHOIS DomainTools search](./screenshots/whois-domaintools.png)  
Verified the same IP on **whois.domaintools.com** for registrar and organization details.

![Screenshot 8 â€“ Header parsed via Microsoft Header Analyzer](./screenshots/mha-parser.png)  
Parsed headers through **[Microsoft Header Analyzer](https://mha.azurewebsites.net/)** for automated breakdown and visualization.

![Screenshot 9 â€“ MXToolbox Header Analyzer](./screenshots/mxtoolbox-parser.png)  
Cross-checked results with **[MXToolbox Header Analyzer](https://mxtoolbox.com/EmailHeaders.aspx)** to confirm routing paths and delays.

---

## ğŸ§­ Lessons Learned
- Reading raw headers reveals the true sender path and bypasses deceptive display names.  
- The **Message-ID**, **Return-Path**, and **Received** chain are critical for verifying legitimacy.  
- Always compare **From**, **Reply-To**, and **Return-Path** for mismatched domains.  
- WHOIS lookups and header parsers speed up investigations but manual review remains essential.  
- Proper documentation (Date, From, Subject, Message-ID, IPs) ensures traceability in incident reports.

---

## ğŸ“š Resources
- [Email Header Package for Sublime Text](https://packagecontrol.io/packages/Email%20Header)  
- [13Cubed Email Header Repo](https://github.com/13Cubed/EmailHeader)  
- [IANA Message Header Registry](https://www.iana.org/assignments/message-headers/message-headers.xhtml)  
- [WHOIS DomainTools](https://whois.domaintools.com/)  
- [Microsoft Header Analyzer](https://mha.azurewebsites.net/)  
- [Microsoft MHA GitHub Repo](https://github.com/microsoft/MHA)  
- [MXToolbox Header Analyzer](https://mxtoolbox.com/EmailHeaders.aspx)
